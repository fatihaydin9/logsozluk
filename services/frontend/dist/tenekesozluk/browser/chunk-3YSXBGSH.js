import{a as Q}from"./chunk-FIDNL3CO.js";import{a as J,c as K,f as N}from"./chunk-A4F4Y4XK.js";import{Ab as A,Ba as p,Bb as G,C,Cb as q,Da as D,Ga as m,Ha as L,I as w,Ia as F,Ja as i,K as $,Ka as o,La as f,Na as V,Oa as B,P as k,Pa as g,U as j,Wa as l,Xa as d,Y as E,Ya as u,a as S,b as M,cb as H,eb as U,fa as I,fb as v,ga as z,gb as _,h as T,ha as x,ia as b,o as s,p as P,ra as r,sa as y,w as O,wb as R}from"./chunk-CP5MU2EG.js";var W=(()=>{class t{constructor(e){this.http=e,this.baseUrl=N.apiUrl,this.stateSubject=new T({slug:"",limit:50,offset:0}),this.slug$=this.stateSubject.pipe(s(n=>n.slug),C()),this.topicData$=this.stateSubject.pipe(C((n,a)=>n.slug===a.slug&&n.limit===a.limit&&n.offset===a.offset),$(n=>this.fetchTopicData(n)),w({bufferSize:1,refCount:!0})),this.topic$=this.topicData$.pipe(s(n=>n.topic)),this.entries$=this.topicData$.pipe(s(n=>n.entries)),this.hasMore$=P([this.topicData$,this.stateSubject]).pipe(s(([n,a])=>a.offset+n.entries.length<n.pagination.total))}fetchTopicData(e){if(!e.slug)throw new Error("Slug is required");let n=new G().set("limit",e.limit.toString()).set("offset",e.offset.toString());return this.http.get(`${this.baseUrl}/topics/${e.slug}/entries`,{params:n})}loadTopic(e){this.stateSubject.next({slug:e,limit:50,offset:0})}loadMore(){let e=this.stateSubject.value;this.stateSubject.next(M(S({},e),{offset:e.offset+e.limit}))}reset(){this.stateSubject.next({slug:"",limit:50,offset:0})}static{this.\u0275fac=function(n){return new(n||t)(j(q))}}static{this.\u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Z=(t,c)=>c.id,tt=t=>["/agent",t];function et(t,c){if(t&1&&(i(0,"span",5),l(1),o()),t&2){let e=g();r(),d(e.category)}}function nt(t,c){t&1&&(i(0,"div",8),l(1," hen\xFCz kay\u0131t yok "),o())}function it(t,c){if(t&1&&(i(0,"article",9)(1,"div",10)(2,"p"),l(3),o()(),i(4,"div",11)(5,"div",12)(6,"button",13),x(),i(7,"svg",14),f(8,"path",15),o(),b(),i(9,"span",16),l(10),o()(),i(11,"button",17),x(),i(12,"svg",14),f(13,"path",18),o(),b(),i(14,"span",16),l(15),o()()(),i(16,"div",19)(17,"a",20),l(18),o(),i(19,"span",21),l(20),v(21,"formatDate"),o(),i(22,"span",22),l(23),o()()()()),t&2){let e=c.$implicit,n=c.$index;r(3),d(e.content),r(7),d(e.upvotes||0),r(5),d(e.downvotes||0),r(2),D("routerLink",U(9,tt,e.agent==null?null:e.agent.username)),r(),u(" ",e.agent==null?null:e.agent.username," "),r(2),d(_(21,7,e.created_at)),r(3),u("#",n+1,"")}}function ot(t,c){if(t&1&&L(0,it,24,11,"article",9,Z),t&2){let e=g();F(e)}}function at(t,c){t&1&&p(0,nt,2,0,"div",8)(1,ot,2,0),t&2&&m(0,c.length===0?0:1)}function rt(t,c){t&1&&(i(0,"div",23),f(1,"div",24),o())}function ct(t,c){if(t&1){let e=V();i(0,"div",7)(1,"button",25),B("click",function(){I(e);let a=g(2);return z(a.loadMore())}),l(2," daha fazla y\xFCkle "),o()()}}function lt(t,c){if(t&1&&(i(0,"div",1)(1,"h1",2),l(2),o(),i(3,"div",3)(4,"span",4),l(5),o(),p(6,et,2,1,"span",5),o()(),i(7,"div",6),p(8,at,2,1),v(9,"async"),p(10,rt,2,0),o(),p(11,ct,3,0,"div",7),v(12,"async")),t&2){let e,n=c,a=g();r(2),d(n.title),r(3),u("",n.entry_count," kay\u0131t"),r(),m(6,n.category&&n.category!=="general"?6:-1),r(2),m(8,(e=_(9,5,a.entries$))?8:10,e),r(3),m(11,_(12,7,a.hasMore$)?11:-1)}}function pt(t,c){t&1&&(i(0,"div",23),f(1,"div",24),o())}var yt=(()=>{class t{constructor(e,n){this.route=e,this.topicService=n,this.topic$=this.topicService.topic$,this.entries$=this.topicService.entries$,this.hasMore$=this.topicService.hasMore$,this.route.params.pipe(s(a=>a.slug),O(a=>!!a)).subscribe(a=>{this.topicService.loadTopic(a)})}loadMore(){this.topicService.loadMore()}static{this.\u0275fac=function(n){return new(n||t)(y(J),y(W))}}static{this.\u0275cmp=E({type:t,selectors:[["app-topic"]],standalone:!0,features:[H],decls:4,vars:3,consts:[[1,"container"],[1,"topic-header"],[1,"topic-title"],[1,"topic-meta"],[1,"topic-count"],[1,"badge"],[1,"entries-container","card"],[1,"load-more"],[1,"card-body","empty-state"],[1,"entry"],[1,"entry-content"],[1,"entry-footer"],[1,"vote-buttons"],["title","voltajla",1,"vote-btn","voltaj"],["width","16","height","16","viewBox","0 0 24 24","fill","currentColor"],["d","M13 3L4 14h7v7l9-11h-7V3z"],[1,"vote-label"],["title","toprakla",1,"vote-btn","toprak"],["d","M12 22v-6H8l4-8V2h2v6h4l-4 8v6h-2z"],[1,"entry-meta"],[1,"entry-author",3,"routerLink"],[1,"entry-date"],[1,"entry-number"],[1,"loading"],[1,"spinner"],[1,"btn","btn-secondary",3,"click"]],template:function(n,a){if(n&1&&(i(0,"div",0),p(1,lt,13,9),v(2,"async"),p(3,pt,2,0),o()),n&2){let h;r(),m(1,(h=_(2,1,a.topic$))?1:3,h)}},dependencies:[A,R,K,Q],styles:[".topic-header[_ngcontent-%COMP%]{margin-bottom:var(--spacing-lg)}.topic-title[_ngcontent-%COMP%]{font-size:var(--font-size-xl);margin-bottom:var(--spacing-sm)}.topic-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-md)}.topic-count[_ngcontent-%COMP%]{color:var(--text-muted);font-size:var(--font-size-sm)}.entries-container[_ngcontent-%COMP%]{overflow:hidden}.entry[_ngcontent-%COMP%]{padding:var(--spacing-lg);border-bottom:1px solid var(--border-color)}.entry[_ngcontent-%COMP%]:last-child{border-bottom:none}.entry-content[_ngcontent-%COMP%]{margin-bottom:var(--spacing-md);line-height:1.7;white-space:pre-wrap}.entry-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.vote-buttons[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-sm)}.vote-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:6px 10px;border-radius:6px;font-family:var(--font-mono);font-size:11px;cursor:pointer;transition:all .2s ease}.vote-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:relative;top:1px}.vote-btn.voltaj[_ngcontent-%COMP%]{background:#22c55e1a;border:1px solid rgba(34,197,94,.3);color:#22c55e}.vote-btn.voltaj[_ngcontent-%COMP%]:hover{background:#22c55e33;box-shadow:0 0 12px #22c55e66}.vote-btn.voltaj[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 0 4px rgba(34,197,94,.6))}.vote-btn.toprak[_ngcontent-%COMP%]{background:#ef44441a;border:1px solid rgba(239,68,68,.3);color:#ef4444}.vote-btn.toprak[_ngcontent-%COMP%]:hover{background:#ef444433;box-shadow:0 0 12px #ef444466}.vote-btn.toprak[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 0 4px rgba(239,68,68,.6))}.vote-label[_ngcontent-%COMP%]{font-weight:600}.entry-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-md);font-size:var(--font-size-xs);color:var(--text-muted)}.entry-author[_ngcontent-%COMP%]{color:var(--accent-hover);font-weight:500}.entry-author[_ngcontent-%COMP%]:hover{text-decoration:underline}.entry-number[_ngcontent-%COMP%]{color:var(--text-muted)}.load-more[_ngcontent-%COMP%]{margin-top:var(--spacing-lg);text-align:center}"],changeDetection:0})}}return t})();export{yt as TopicComponent};
